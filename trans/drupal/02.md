# 第二章开发环境的建立

*发展环境究竟是什么？我为什么需要它？*人们普遍认为，在建立网站的过程中，不应让人们通过互联网使用网站。让你的网站*上线*，而你仍在进行更改、破坏和修复，这意味着人们有可能找到你的网站，试图使用它，并对你的网站开发技能形成极坏的评价。在最坏的情况下，您可能会发现，由于安全设置实施不当，您甚至无意中允许恶意用户访问敏感信息。

与其让公众访问您正在进行的工作，不如在家用或办公电脑上设置一个支持 PHP 的 web 服务器。在将最终产品转移到实时网站之前，可以使用该服务器以及 PHP 和数据库来设计和构建您想要的一切。开发环境正是这台机器及其附带的开发工具和技术，您可以在其中构建站点。因此，本章将确保您正确有效地进行设置，以便您可以在接下来的章节中直接开始使用 Drupal。

具体而言，我们将讨论以下重要主题：

*   简要介绍所涉及的技术
*   获取和安装 Apache、MySQL 和 PHP
*   获取和安装 Drupal
*   升级 Drupal
*   常见问题的故障排除
*   Drupal 的短途旅行

Apache、MySQL 和 PHP 的安装和设置将只在 Windows 中介绍，因为我们相信 Linux 黑客已经安装好了所有东西（或者知道如何安装）。万一你没有安装好所有的东西，快速浏览一下相关软件网站上的说明就足以让你站起来。Drupal 的安装过程与 Windows 和 Linux 的基本相同；所以使用这两种方法的人都可以跟随*获取和安装 Drupal*部分。

然而，在我们开始之前，有一点至关重要的建议需要给出：

### 注

确保您能够访问良好的、最好是闪电般快速的互联网连接，因为您将下载相当数量的软件。

对于那些已经安装了各种软件的用户，您可能会发现跳过您不需要的部分是很方便的，只跳过那些感兴趣的部分。除了提供有关安装的信息外，本章还将有一个疑难解答部分，解决与 Drupal 安装过程相关的一些最常见错误。

还应注意的是，由于 Drupal 的开发考虑到了灵活性，因此可以在 IIS 之外使用它作为替代 web 服务器，也可以使用 PostgreSQL 作为替代数据库，因为对这些数据库的支持正在积极开发中。我们将重点介绍 Apache、MySQL 和 PHP 最流行的组合，而不是展示如何设置每一个。

# Drupal 环境

我知道你们中的大多数人现在都渴望开始工作，并且可能更愿意直接对 Drupal 站点进行修改。在我们这样做之前，请花一些时间阅读本节，了解幕后的一切是如何组合起来的，这将对您真正有好处。掌握各种技术如何合作的基本知识，以便为您提供一个可工作的 Drupal 站点，从长远来看，这将对您带来不可估量的帮助。

首先要做的最好的事情是看看我们将要使用的每一种底层技术：

*   **PHP:**PHP 或 PHP 超文本预处理器是编写 Drupal 的语言。最近，它得到了重大升级，现在或多或少是一种功能齐全的**面向对象语言**，具有一些非常强大的功能。PHP 在互联网上广泛用于各种不同的项目，并以其易用性而闻名。PHP 的当前版本是 PHP5，这是我们在本书中演示的内容，因为最新版本的 Drupal 是 PHP5 友好的。但是，欢迎您使用版本 4，因为这是目前大多数 internet 服务提供商使用的版本。好消息是，我们不必深入钻研编程代码来构建我们的站点，Drupal 可以处理大部分（如果不是全部的话）复杂的编程问题。
*   **Apache:**这是我们将在开发阶段用于服务网页的 web 服务器。Apache 是 Internet 上最流行的 web 服务器，每天有数百万个实时站点使用它。事实上，正如 Apache 网站所说：*比所有其他 web 服务器加起来*使用得更广泛。
*   **MySQL:**这是一个数据库软件，我们将使用它来存储保持网站运行所需的所有信息。从客户详细信息到产品信息以及大量其他内容都将存储在 MySQL 数据库中。随着流行趋势的发展，MySQL 也是世界上最受欢迎的数据库软件，在全球有超过 600 万的活动安装。

现在，由于我们不想浪费太多时间下载和安装我们需要的所有不同的软件，我们将使用软件包安装，它只需一次安装即可提供我们所需的一切。我们在本书中使用的软件包名为**Apache2Triad**。

既然我们知道了*我们正在使用的*是什么，那么快速了解*我们将如何使用*是很重要的。下图显示了一切工作方式的简化视图，阴影部分表示 Apache2Triad 包，其中包含 ApacheWeb 服务器、PHP 解释器和 MySQL 数据库，系统上安装了 Drupal:

![The Drupal Environment](graphics/1800_02_01.jpg)

因此，每当用户对您的 Drupal 站点做任何事情时（希望是有意义的贡献），都会发生以下情况：

1.  相关信息以 HTTP（超文本传输协议）请求的形式捆绑到服务器。HTTP 请求有两种形式， `GET`或 `POST`。出于我们的目的，了解 `GET`和 `POST`的工作原理并不重要，只要您了解可以从用户处捕获信息并发送到服务器，以便使用这些请求进行处理。
2.  服务器收到 HTTP 请求并说，*啊！这是一个已请求的 PHP 页面。我需要将其发送给 PHP 引擎*进行处理。然后对 PHP 页面进行适当的处理和执行，并执行用户请求所需的任何操作。
3.  完成后，服务器将向用户的浏览器返回一个适当的响应，该循环将继续。

有很多方法可以提供不依赖 PHP 服务器请求的动态 web 内容。相反，处理在应用程序的客户端完成（换句话说，在 web 浏览器上）。稍后，我们将在[第 9 章](09.html "Chapter 9. Advanced Features and Modifications")中探讨如何使用 JavaScript 增强您的网页，但这里向您展示的是基本上一切都是如何工作的，即使规则中存在例外。

虽然本节对与 Drupal 相关的底层技术有点旋风式的介绍，但这里包含的信息在某些阶段应该是非常宝贵的。例如，了解每件事是如何结合在一起的通常会帮助您找出遇到的任何问题的原因，从而使您能够更快地解决这些问题。

如果这一切此刻看起来有点令人生畏，不要担心。请记住，Drupal 本身处理与确保一切顺利运行相关的大部分（如果不是全部的话）复杂性。正如您将看到的，我们的工作变成了定制，而不是实际的软件开发。有了这些，让我们开始安装过程。

# 获取并安装 PHP、Apache 和 MySQL

如前一节所述，我们将使用包安装来简化创建可行开发环境的任务。您会注意到，大多数软件安装实际上是学习单个过程，并为您需要的任何软件重复它。通常情况下，您会：

1.  转到软件生产商的网站
2.  找到下载页面
3.  下载软件
4.  根据安装方法，解压缩软件或运行可执行文件
5.  安装软件
6.  配置您的安装
7.  测试你的设置

这听起来很容易；因此，请前往[http://apache2triad.net/](http://apache2triad.net/) ，这是 Apache2Triad 项目的主页，点击屏幕底部左侧框中的**下载**链接。（请随意浏览以了解有关这一有用企业的更多信息。）这将带您进入 SourceForge 网站的下载页面：[http://sourceforge.net/project/showfiles.php?group_id=93507](http://sourceforge.net/project/showfiles.php?group_id=93507) 。

选择您希望用于本书目的的软件包，使用的是发行版软件包 1.5.3。在撰写本文时，这是最新的稳定版本，但是如果有更高的版本，您可以随意使用，因为这不会影响您在这里的后续操作。一旦您点击**下载**获取软件包，您将看到一个下载选项列表。发布包 1.5.3 只有一个选项，如下所示：

![Obtaining and Installing PHP, Apache, and MySQL](graphics/1800_02_02.jpg)

这是我们将下载并安装的软件包。要做到这一点，只需单击 `package name .exe`文件，它将带您进入镜像站点列表，您可以从中选择一个站点为您提供下载。镜像只是一个服务器，它在不同的地理位置提供所有相同的设施。这样做是为了减少单个服务器上的负载，并为全球各地的人们提供更快的下载。选择并点击**下载**开始。

根据电脑的安全设置，您可能会收到以下警告消息：

![Obtaining and Installing PHP, Apache, and MySQL](graphics/1800_02_03.jpg)

只需点击**运行**即可继续（如果您想保留副本，可点击**保存**。此时，如果您的连接速度较慢，您可能需要休息一下，喝杯咖啡或茶，因为这可能需要一段时间。

在安装过程的某个阶段，安装程序会要求您确认几个设置，您可以根据提示进行更改。所有可配置的设置都有合理的默认值；所以你真的不必为这件事操心太多。但是，系统将要求您输入密码。请确保您使用的东西对您来说是值得纪念和安全的。您需要使用 8 个或更多字符，最好使用一些数字作为密码的一部分。

### 注

确保您能够记住所需的密码，以便稍后在安装过程中运行初始化任务。

完成所有操作后，您将收到以下消息：

![Obtaining and Installing PHP, Apache, and MySQL](graphics/1800_02_04.jpg)

确保在单击**确定**之前保存并关闭所有已打开的重要文档。一旦您的机器重新启动，您将发现在**开始**菜单中**所有程序**下的**Apache2Triad**选项中有一整套全新且令人兴奋的选项可供探索。例如，1.5.3 发行版提供了以下选项：

![Obtaining and Installing PHP, Apache, and MySQL](graphics/1800_02_05.jpg)

我们目前需要的远不止这些，但为了确保一切都按计划进行，请单击**开始**菜单中的**打开站点根目录**，您应该会在默认浏览器中看到以下网页：

![Obtaining and Installing PHP, Apache, and MySQL](graphics/1800_02_06.jpg)

这证实了一切都按预期进行。到目前为止相当容易！在上一个截图中需要注意的一点是最后一个名为**htdocs**的链接。传统上，在 Apache 服务器中，文件系统中名为 `htdocs`的文件夹称为*根*文件夹。这意味着你网站的所有网页和文件夹都必须放在 `htdocs`中，以便 Apache 为它们提供服务。如果 `htdocs`中没有内容，则无法浏览！

由此我们知道，我们必须在文件系统上找到名为 `htdocs`的实际文件夹，以便在下载 Drupal 后知道将其放置在何处。假设您使用了默认设置，您将在以下目录（在 Windows 计算机上）中找到 `htdocs`以及安装期间安装和创建的所有其他内容： `C:/apache2triad/`。

在我们从这里开始之前，值得一看作为 Apache2Triad 安装的一部分提供了什么，因为随着时间的推移，提供给您的一些设施可能会非常有用。您还将发现，live 站点上的许多托管软件包提供的功能与您现在在 PC 上的功能几乎相同。

我们 Drupal 人特别感兴趣和使用的是 phpMyAdmin，它是一个完整的 MySQL 数据库管理工具。它可以让你的生活变得更容易，因为你变得更先进，并希望玩你的数据。通过使用 phpMyAdmin，您完全可以执行所需的大部分任务，而不必学习 MySQL 命令行客户机上的 SQL。

### 注

如果您很难登录到 phpMyAdmin 或该站点的任何其他部分，请尝试使用**root**作为用户名和在安装过程中设置的任何密码。

我们现在有了一个平台，可以开始构建 Drupal 站点。当然，我们仍然需要 Drupal。

# 获取并安装 Drupal

[第 1 章](01.html "Chapter 1. Introduction to Drupal")已经查看了 Drupal 站点上的下载页面；因此，在这一点上，没有太多的问题向我们提出。前往[http://drupal.org/project/Drupal+项目](http://drupal.org/project/Drupal+project)并点击您想要下载的 Drupal 版本号，您应该选择*最新的稳定版本*。点击**下载**获取最新副本并将其保存到您的 `C:`驱动器或 `My Documents`文件夹（或任何您想要的地方）。

现在，Drupal 下载与 Apache2Triad 安装程序不同，我们将自己安装 Drupal；它没有自己的安装程序 `.exe`文件。相反，我们被询问是否要**保存**（或**打开）**一个 `.tar.gz`文件。如果您发现您的电脑无法识别 `.gz`文件（这是针对 Windows 用户的），那么您需要下载一个类似 WinZip（[的 zip 程序 http://www.winzip.com](http://www.winzip.com) ），或者最好是一个开源选项，比如 7-zip（[http://www.7-zip.org](http://www.7-zip.org) 。

一旦您感到满意，就可以打开并解压缩下载的 `tar.gz`文件，然后将其解压缩到 Apache 安装的 `htdocs`文件夹中。如果您现在看一看，您将看到如下内容：

![Obtaining and Installing Drupal](graphics/1800_02_07.jpg)

我们仍然需要创建一个数据库，并用 Drupal 运行所需的所有表和结构填充它，即使从技术上讲，您可以尝试浏览 Drupal 页面，因为它们现在位于 `htdocs`文件夹中。有很多方法可以做到这一点，但让我们坚持最基本的，以使本节适用于所有人。

1.  打开命令行 shell。在 Windows 中，单击**开始**，选择**运行**并键入**cmd**即可完成此操作。
2.  在提示符处键入以下命令：

    ```
    C:\ mysqladmin -u root -p create drupal

    ```

3.  出现提示时输入密码。（这是您在设置 Apache2Triad 时输入的。）
4.  使用以下命令进入 MySQL 命令行提示符：

    ```
    C:\ mysql -u root p

    ```

5.  再次，在出现提示时输入到目前为止一直使用的相同密码。
6.  要专门为 Drupal 设置数据库用户名和密码，请输入以下命令：

    ```
    mysql> GRANT ALL PRIVILEGES ON drupal.* TO nobody@localhost IDENTIFIED BY
    'password';

    ```

7.  Remember to substitute values that are relevant to yourself in place of the bolded sections of this command—nobody (your username), and `password` (your password). After this, you should have a screen that looks something like the following:

    ![Obtaining and Installing Drupal](graphics/1800_02_08.jpg)

8.  接下来，输入以下命令以确保这些设置立即生效：

    ```
    mysql> flush privileges;

    ```

9.  键入 quit 退出 MySQL 命令行客户端，然后通过键入

    ```
    $> mysql -u drupal -p drupal < C:/apache2triad/htdocs/drupal-4.7.0/
    database/database.4.1.mysql

    ```

    加载数据库
10.  请记住输入您为 drupal 数据库用户设置的正确密码。在本例中，密码为 ny4thi，如上图所示。粗体部分可能会根据您在上一步中定义的用户以及您获得的 Drupal 版本而改变。

此时，Drupal 的所有数据库设置都已执行，为了完成安装过程，我们只需要处理一些配置任务。对于那些有兴趣快速了解安装过程中引擎盖下发生的事情的人，请使用以下命令打开 MySQL 命令行提示符：

```
$> mysql udrupal p drupal

```

出现提示时输入密码，然后在命令行中键入以下内容：

```
mysql> show tables;
mysql> select * from <tablename>;

```

第一个命令将列出 `drupal`数据库中现在存在的所有表。下一个命令可用于查看任何给定表格中的信息，方法是将其中一个表格替换为`<tablename>`。通过查看结果，您应该能够看到，已经做了大量的工作，以确保我们的网站所需的一切都已创建。

我们现在可以进入配置设置了！

导航至`C:\apache2triad\htdocs\`**Drupal-4.7.0**`\ sites\default`进入 Drupal 安装-显然，您的版本号可能会有所不同。在您选择的编辑器中打开 `settings.php`文件，并修改第 81 行或其周围的以下行：

```
$db_url = 'mysql://username:password@localhost/database';

```

例如，演示站点的设置现在是：

```
$db_url = 'mysql://drupal:ny4thi@localhost/drupal';

```

因为正如您所知，我们创建了一个名为 `drupal`的用户，并为该用户提供了密码 `ny4thi`，这允许他们访问使用下载中提供的 SQL 脚本创建的 `drupal`数据库。目前我们唯一需要考虑的另一个设置是描述网站地址的基本 URL，填写此设置是可选的；因此，如果您在第一次查看站点时发现断开的链接等问题，请返回此设置。

假设您没有在网络中使用其他服务器，只需将额外文件夹添加到默认地址，并从行的前面删除哈希（#）符号，如下所示：

```
$base_url = 'http://localhost/drupal-4.7.0';

```

记住根据您下载的包将粗体部分更改为正确的 Drupal 版本。

如果已将文件保存到其他位置，则需要相应地进行配置设置。完成后，保存对文件的更改并准备进行 acid 测试。如果一切都按计划进行，当您在浏览器中导航到基本 URL 时，应该会看到一个新的 Drupal 网站，如下所示：

![Obtaining and Installing Drupal](graphics/1800_02_09.jpg)

如果这不是你看到的屏幕（或者离它很近的屏幕），那么不要担心。很快就会有一个故障排除部分和一个完整的社区，充满了帮助解决问题的论坛。然而，如果这是您看到的，那么恭喜您，您现在是一个默认 Drupal 网站的骄傲管理员。当然，如果您不想每次访问网站时都输入 `drupal‑4.7.0`，您可以随意更改此文件夹的名称。

### 注

确保您对 `settings.php`中的 `$base_url`变量进行了相应的更改，以反映对地址的任何更改，否则最终将导致站点中断。

实际上，这就是安装 Drupal 所需要做的全部工作。此后，其他一切都是配置和定制。我们首先需要做的事情之一是设置一个管理员帐户，有关它的所有说明都显示在您的默认网页上，如前一个屏幕截图所示。在我们对 Drupal 做一个简短的介绍，在此过程中设置管理员帐户之前，我们需要看看其他一些问题。

# 升级 Drupal

为了使您的站点保持最新速度和无故障，有时需要升级您的 Drupal 安装。例如，有时可能会发现一个安全问题，人们必须升级以避免成为恶意黑客的牺牲品。不要对此太担心。所有的软件，无论是专有的还是开源的，都有弱点。弱点是你无法逃避的。重要的是一旦发现它们，如何处理它们。在 Drupal 的例子中，有一整个社区的人在监视 bug，报告 bug，修复 bug，然后免费向所有用户提供解决方案。

因此，如果有必要，您必须知道如何进行无痛升级。正如您对 Drupal 的期望，这个过程相当简单，但在我们研究它之前，我应该警告您：

### 注

如果您使用的主题不是默认主题，则您的站点可能会中断。在执行升级之前，最好恢复到默认主题。

现在，这张便条根本不应该让你担心，因为我们甚至还没有讨论过主题，但在以后的日子里记住它可能会很方便。让我们继续：

1.  对当前数据库进行备份，以便保留用户添加的所有信息以及已实施的任何配置更改。（在[第 10 章](10.html "Chapter 10. Running Your Website")中讨论了备份。如果您需要在此期间进行备份，请快速查看。）
2.  备份旧文件，尤其是那些具有重要设置的文件，如样式表或 `sites/default/directory`中包含的配置文件。这允许您在新站点上重新实施任何重要设置。
3.  从文件系统中删除所有旧 Drupal 文件，并假设您希望从同一位置运行站点，则将所有新文件解压到同一文件夹中。
4.  根据旧配置文件中保存的设置对配置文件进行必要的更改。
5.  Log in as the site administrator (this has to be user number 1), then navigate to your Drupal homepage and run the `update.php` script by accessing it from your browser. For example, the demo site's update page would be `http://localhost/drupal-4.7.0/update.php`. This will bring up a page of notes as follows:

    ![Upgrading Drupal](graphics/1800_02_10.jpg)

6.  在单击**运行数据库升级脚本**链接之前，请仔细阅读这些说明，以确保执行任何可能需要的特定于版本的任务。
7.  Click the link to bring up the following page:

    ![Upgrading Drupal](graphics/1800_02_11.jpg)

8.  选择要执行的更新（仅当出于某种原因，您对自动选择不满意时），然后单击**更新**。如果一切顺利，您应该看到已执行的更新列表，以及这些操作的状态；类似这样的：

![Upgrading Drupal](graphics/1800_02_12.jpg)

您现在已完全更新，可以正常继续。当您需要升级时，您应该查看另一个有价值的信息源，即 Drupal 站点本身：[http://drupal.org/upgrade/](http://drupal.org/upgrade/) 。本页包含有用的注释、版本特定的问题和说明，这些内容可能很有用。

# 常见故障排除

在本节中，我们将了解安装过程中最可能出现的两个问题。我们还将了解它们是如何表现出来的，以及如何快速解决它们。应该注意的是，在这个早期阶段，不会有太多的事情出错，因为安装例程使用得相当好，并且大多数（如果不是全部的话）bug 都已经解决了。这对我们来说是个好消息，因为任何错误都可能是打字错误或其他相当简单的错误造成的，应该很容易纠正。

不幸的是，我们不能希望在本节中涵盖所有内容；因此，我们还将概述一个简短的过程，您可以使用它来解决任何问题，而不仅仅是与安装有关的问题。无论何时遇到问题，都要有一个合理的过程来遵循，这比向你展示解决每一个问题的方法更有价值。在本节结束时，您应该确信您可以安装和升级 Drupal，以及处理过程中可能出现的任何问题。让我们开始吧。

如果您收到如下消息，而不是默认主页：

![Troubleshooting Common Problems](graphics/1800_02_13.jpg)

那么很可能您在 `/sites/default/settings.php`文件中的连接字符串中输入了错误。重新检查此文件以确保您提供的名称和密码正确。如果找不到问题，请在 `settings.php`文件中输入您的根目录名和密码，以查看您是否可以使用该文件登录。如果这样做有效，那么您知道用户和/或他们的权限存在问题，而不是其他任何问题，因此再次检查步骤 5 中的 `GRANT`语句，并确保它与 `settings.php`文件中的设置匹配。

在上一个屏幕截图中， `settings.php`文件中给出的用户名有一个输入错误，导致 Drupal 尝试使用用户名 `drupa`而不是 `drupal`连接 MySQL。当然，你们中的一些人可能已经越过了这一点，但却得到了这样的东西：

![Troubleshooting Common Problems](graphics/1800_02_14.jpg)

正如你所看到的，我们就快到了，但是在这条线路的某个地方肯定出了问题，这可以从断开的链接和缺少任何格式和样式中得到证明。此错误最有可能的原因是错误地设置了基本 URL。在 4.7 及更高版本中，这应该不是什么大问题，因为 Drupal 会自动检测此 URL。但是，如果您将 `htdocs`中 Drupal 文件夹的名称改为 `drupal`而不是原来的 `drupal-4.7.0`，则在不调整基本 URL 的情况下浏览该地址可能会导致此类问题。

要解决此问题，请确保您在浏览器上找到页面的地址与 `settings.php`文件中给出的地址相同，减去尾随斜杠，如下所示：

```
$base_url = 'http://localhost/drupal-4.7.0';

```

哦，亲爱的，你可以看到，这仍然是旧的价值观；因此，我们需要对其进行更新，以匹配上一个屏幕截图中的地址，如下所示：

```
$base_url = 'http://localhost/drupal';

```

一旦设置正确，您将发现站点自身显示正确。*但如果其他事情出了问题怎么办？*那么，在这一点上，可能发生的问题的类型是不容易隔离的；所以你最好知道如何着手解决这些问题。以下要点列表强调了您应该使用的流程，以便对任何问题进行故障排除：

1.  仔细检查您收到的任何错误消息，并尝试自己解决问题。
2.  访问 Drupal 论坛并搜索类似问题。
3.  查看[中的故障排除常见问题 http://drupal.org/node/199](http://drupal.org/node/199) 。
4.  查看错误列表（[http://drupal.org/project/issues](http://drupal.org/project/issues) 查看您的问题是否是报告的错误。
5.  如果你找不到 bug、类似帖子或问题，那么试着在论坛上发布你的疑问，并请社区中的人帮你一把。
6.  为了补充这一点，请登录谷歌，尝试使用相关关键字查找类似的问题，并有望找到解决方案。

此时，您不太可能需要使用所有六个选项，但在未来的某个阶段，您可能会发现，您需要的专业知识比通过网络搜索获得的要多。如果是这样的话，那么不要绝望，只要你愿意支付费用，就有顾问可供选择。不过现在，您应该准备好继续安装过程中的最后几个任务，这些任务将在下一节中执行。

# 短暂的 Drupal 之旅

在我们继续讨论定制和配置主题之前，重要的是我们要浏览一下 Drupal 的实际外观，并确保它正常运行。为了做到这一点，我们需要查看一些 PHP 设置。一旦这些都处理好了，我们将不得不创建第一个用户谁将控制网站的各个方面。如果不讨论实际的 Drupal 页面，任何 Drupal 之旅都是不完整的，因此，一旦我们完成游戏，我们将在本节末尾查看一个示例。

首先，让我们先处理 PHP。

## 几个重要的设置

我将演示 Apache2Triad 设置所需的更改，但是如果您使用了其他任何东西（或者如果您已经安装了所有东西），您可能会注意到布局方式上的细微差异。现在，我们之所以需要这么做，是因为我们显然希望 Drupal 发送的任何电子邮件都来自我们可以访问的工作电子邮件地址，我们需要检查 Drupal 用于发送电子邮件的 `mail()`功能是否有 SMTP 服务器。由于我们最终将不得不在线路的某个地方设置此选项（假设尚未设置），我们不妨现在就设置。

打开您的 `php.ini`文件，在 Windows 上使用 Apache2Triad 可以在 `C:\WINDOWS`中找到该文件。搜索以下内容的行：

```
[mail function]
; For Win32 only.
SMTP = localhost
smtp_port = 25
; For Win32 only.
sendmail_from = admin@localhost
; For Unix only. You may supply arguments as well (default: "sendmail -t -i").
;sendmail_path =

```

您需要为 PHP 提供一个在这里工作的 SMTP 服务器。如果您在 Windows 上使用 Microsoft Outlook，则可以通过查看**工具【账户】属性**菜单中的“服务器”选项卡，找到您已经在使用的 SMTP 服务器。除此之外，您可能还希望在此处设置 `admin@localhost`以外的内容；因此，请确保做出相应的更改。对于演示站点，进行了以下更改：

```
[mail function]
; For Win32 only.
SMTP = smtp.dsl.<myserver>.net
smtp_port = 25
; For Win32 only.
sendmail_from = staff@contechst.com
; For Unix only. You may supply arguments as well (default: "sendmail -t -i").
;sendmail_path =

```

显然，如果您没有可以关闭的服务器，那么您就不能从您的站点发送电子邮件，那么您必须能够访问正在工作的 SMTP 服务器。目前这并不是一个大问题，当然，您的实时站点将能够发送邮件，即使您不能从您的开发机器发送邮件。

### 注

为了使这些设置生效，您还必须记住重新启动 Apache 服务器。

您可以通过双击进程托盘（屏幕右下方）中的 Apache 图标并在菜单中选择**重新启动**来重新启动 Apache。您也可以通过**开始**菜单访问服务器。完成此操作后，您可以按照常规继续使用 Drupal。

## 创建管理用户

正如默认 Drupal 页面上提到的，您需要单击**创建第一个帐户**链接才能开始。这将打开注册页面，您可以适当地填写该页面。单击**创建新帐户**后，Drupal 将自动尝试发送欢迎电子邮件（如果您收到电子邮件，则您知道您的 SMTP 设置正在工作），并打印一条消息，如图所示：

![Creating an Administrative User](graphics/1800_02_15.jpg)

请注意，不仅一封电子邮件已成功发送到我在注册过程中指定的地址，而且该电子邮件来自我稍早在 `php.ini`文件中指定的地址。

### 注

如果您没有 internet 连接，您仍然可以设置 Drupal 站点，但无法使用第三方 STMP 服务器发送和接收电子邮件，如图所示。

到现在为止，一直都还不错！下一步是在网站中输入新密码记住选择比当前分配的密码更容易记住的密码。完成后，只需单击页面底部的**提交**即可继续。您可能希望先查看一些其他设置并进行快速更改（例如添加**签名**或更改**时区）**。

## 使用管理面板

在我们下一章开始更严肃的建设我们的网站之前，是时候好好享受一下了。编辑完用户设置后，单击页面左侧方框中显示的**管理**链接。这样会出现这样一个页面（选择了**模块**选项）：

![Using the Administrative Panel](graphics/1800_02_16.jpg)

在我们真正玩任何东西之前，列出每个选项的作用是值得的，因为当你进入大量的东西时，它可能会变得有点混乱，主要是因为有大量可用的菜单项，而不是因为网站特别难以管理。请特别注意以下事项：

### 注

**管理**菜单项下的可用部分可能会根据您启用的模块、您添加的贡献、甚至为用户分配的权限而变化。

这意味着您应该始终确保在添加并启用新模块后，检查任何给定部分中有哪些新选项可用。您还应该知道，并非所有用户都有相同的**管理**选项，因此您需要检查他们是否有足够的权限来完成预期任务。我们将在以后更详细地研究这一切；因此，在这一点上没有必要超越我们自己。

以下列表概述了核心选项：

*   **访问控制：**允许您设置权限来控制用户在您的站点上可以做什么。
*   **块：**启用的块可以显示在您站点的各种位置。块可以包含各种信息，例如谁在线或最新论坛帖子。
*   **类别：**允许管理员对网站内容进行分类和分类。Drupal 以分类模块的形式拥有最复杂的分类系统之一。
*   **评论：**允许管理添加到站点的评论。注释与其他内容类型不太一样，而是附在其他内容类型上。
*   **内容：**允许对站点的任何和所有帖子进行管理。它提供了各种各样的过滤器来减少结果，以便随时找到特定的内容以及更新选项。
*   **输入格式：**Drupal 可以通过多种方式查看用户提供的内容。这包括从过滤的 HTML 到完整的 PHP 代码。
*   **日志：**允许记录各种事件，如使用信息、警告和错误，然后在正常站点的日常维护过程中使用这些事件。
*   **菜单：**允许创建和操作导航结构。从这里可以启用或禁用菜单项，创建新的菜单项，也可以使用主链接。
*   **模块：**提供 Drupal 的功能（Drupal 的标准发行版附带了许多核心模块，有许多贡献的模块需要下载和安装），并且可以根据站点的要求启用或禁用。
*   **设置：**提供了一个方便的页面，从中可以实现站点的一般配置。
*   **主题：**控制网站的外观和感觉。默认情况下，有多种选项可用。请记住，如果您对 PHP、HTML 和 CSS 稍有了解，也可以创建自己的全新主题。
*   **用户：**从这里，您可以添加、删除或编辑站点上的任何和所有用户。
*   **帮助：**包含到 Drupal 手册的链接，以及各种模块的帮助主题，然后是重要术语的简短词汇表。

让我们对网站进行一些修改，看看我们能做些什么。通过选中**已启用**标题下的相关复选框，继续启用**管理**菜单项**模块**部分下的**博客**模块，然后单击**保存配置**。您应该立即注意到，加载的页面有一些更改，以博客相关菜单项的形式在菜单顶部查找新的**我的博客**链接。在我们看到实际站点如何更改之前，请转到**块**（也在**管理下）**并在那里执行相同的操作，确保启用一些块并在**放置**下拉列表下选择**右侧边栏**。

现在不要担心要做哪些具体的更改。我们只是简单地看一下使用管理工具做事情是多么容易。下一节将通过 Drupal 页面截图示例来了解其中一些更改的效果。

## Drupal 页面示例

修改完成后，单击左侧导航栏中的**创建内容**，然后单击**博客条目**。一旦打开博客页面，只需添加一些内容，无论您想要什么，然后单击**预览**查看结果，如果您满意，请单击**提交**。如果您现在注销，您将面临新的默认页面。让我们简要地看一下它的一些主要特征：

![A Sample Drupal Page](graphics/1800_02_17.jpg)

当有人第一次来到你的网站时，就像现在一样，他们很可能会收到如前一个屏幕截图所示的东西。（正如您所知，我已经启用了一系列新模块，并设置了一些块显示在页面的右侧。此外，您可以看到我输入了一条问候语作为我的第一条博客条目，Drupal 会尽职尽责地将其显示在主页上，而不是最初的说明。）本截图中突出显示了几个主要的感兴趣领域，我们应该在这里查看它们，以便在接下来的章节中了解预期内容：

1.  URL 表示正在访问的页面，可以进行修改以提供搜索引擎友好的格式。
2.  页面标题包含站点的徽标和标语以及其他内容。它还提供了到主页的链接，并且是完全可配置的。
3.  搜索工具允许用户输入搜索词，以便在 Drupal 站点中定位内容。
4.  左侧和右侧边栏包含块，这些块实际上是信息的容器，以及导航链接。在本例中，几乎所有内容都已启用，这就是为什么页面的每一侧都有这么多单独的块。还请注意，我们现在在右侧有块，因为我们将其中一些块设置为显示在右侧栏中。块也可以出现在页面的其他部分，我们稍后将处理这些块。
5.  Drupal 中的所有内容都包含在节点中，如图所示。这不一定是一篇博客文章，也可以是民意测验或论坛帖子。当然，显示方法是可定制的，稍后我们还会看到。
6.  用户可以注册并登录该网站以创建帖子或查看内容。可以将权限和角色分配给用户，以允许他们执行各种管理任务等。

这个屏幕截图中没有显示的（因为页面太长）是页脚区域。此部分还可以保存块和其他内容，与站点的其他部分一样，完全可自定义。

我们的 Drupal 短途旅行到此结束。在下一章以及随后的章节中，我们将开始利用 Drupal 核心功能的各个方面（以及寻求一些贡献的帮助），并将其塑造成我们希望创建的站点。同时，我们鼓励您尽可能多地使用该网站，以便了解您可以做什么。

# 总结

为了向您提供完成所有工作的最有效方法，本章介绍了在一个名为 Apache2Triad 的包中安装 PHP、MySQL 和 Apache。因此，你现在有了在未来几天和几周内建立一个现场的基础。花时间建立一个工作开发环境后，您可以放心，通过不直接在现场工作，您已经避免了任何不必要的时间浪费和可能的不良宣传。

现在，您已经在自己的机器上安装了 Apache、PHP 和 MySQL 提供的工具，您可以自由地尝试和使用您的站点，以便了解您的方法。当然，安装必要的技术并不是故事的结束。我们还学习了如何获取和安装 Drupal 本身，希望您能发现这很容易！

在此之后，我们注意到不时地升级 Drupal 是很重要的；因此，我们讨论了如何实现升级以涵盖这一点。毫无疑问，一切都进行得很顺利，但您不能总是保证这一点，因此我们花时间还探讨了与安装相关的一些更常见的问题，并制定了解决一般问题的流程。

最后，我们通过创建一个管理用户并将一些内容发布到站点，从而熟悉了 Drupal 本身。我们花了一点时间，通过启用一两个模块来大幅修改站点，以便观察它对实时站点的影响。利用这个，我们讨论了一个普通 Drupal 页面的主要元素。

如果你已经做到了这一点，那么恭喜你，你已经准备好开始开发你的网站了！是时候把你的手弄脏了…